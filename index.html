<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Nightingale Ledger: Habit and Reward Tracker</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts for the intimate, goth style -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital@0;1;1&display=swap" rel="stylesheet">
    
    <!-- Load Font Awesome Icons (Replaces Phosphor for reliability) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        /* Custom Styles for Goth/Vampiric Ledger Theme */
        body {
            font-family: 'Playfair Display', serif; /* Serif font for body */
            background: linear-gradient(to bottom, #1a1a1d 0%, #0d0d0f 100%); /* Deep charcoal to near black gradient */
            min-height: 100vh;
            color: #d4d4dc; /* Light grey for text */
            margin: 0;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }
        h1, h2, h3 {
            font-family: 'Cinzel', serif; /* Elegant font for headings */
            color: #b05c6c; /* Deep romantic red/plum */
        }
        .card {
            background-color: #2a2a33; /* Darker card background */
            border: 1px solid #4a4a53;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.7);
        }
        .btn-primary {
            background-color: #b05c6c;
            color: #1a1a1d;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-family: 'Cinzel', serif;
            transition: background-color 0.2s;
        }
        .btn-primary:hover {
            background-color: #d37c8c;
        }
        .input-style {
            background-color: #1a1a1d;
            border: 1px solid #4a4a53;
            color: #d4d4dc;
            padding: 0.5rem;
            border-radius: 0.375rem;
        }
        /* Custom scrollbar for an aged look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2a2a33;
        }
        ::-webkit-scrollbar-thumb {
            background: #5c5c63;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #b05c6c;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <!-- Modal Structure -->
    <div id="app-modal" class="fixed inset-0 bg-black bg-opacity-70 z-50 hidden items-center justify-center p-4" onclick="document.getElementById('app-modal').classList.add('hidden')">
        <div class="card p-6 w-full max-w-sm" onclick="event.stopPropagation()">
            <h3 id="modal-title" class="text-2xl mb-4">Modal Title</h3>
            <p id="modal-message" class="text-sm mb-6 text-gray-300">Modal message content.</p>
            <button class="btn-primary w-full" onclick="document.getElementById('app-modal').classList.add('hidden')">
                Acknowledge
            </button>
        </div>
    </div>
    
    <!-- Main Header -->
    <header class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl tracking-wider font-bold">The Nightingale Ledger</h1>
        <p class="text-lg text-gray-400">A Pervasive Habit and Reward Tracker</p>
        <p id="user-id-display" class="text-xs mt-2 text-gray-500 font-mono">Loading User ID...</p>
    </header>

    <!-- Score Display -->
    <section class="grid grid-cols-2 gap-4 mb-8 max-w-4xl mx-auto">
        <div class="card p-4 text-center">
            <h2 class="text-2xl mb-2">The Keeper</h2>
            <p id="score-keeper" class="text-5xl font-bold text-green-400">0</p>
        </div>
        <div class="card p-4 text-center">
            <h2 class="text-2xl mb-2">The Nightingale</h2>
            <p id="score-nightingale" class="text-5xl font-bold text-purple-400">0</p>
        </div>
    </section>

    <!-- Main Tabs -->
    <div class="max-w-4xl mx-auto">
        <div class="flex border-b border-gray-600 mb-4">
            <button id="tab-habits" class="flex-1 p-3 text-center transition-colors font-cinzel text-lg border-b-2 border-b-transparent hover:border-b-[#b05c6c] text-[#b05c6c]" onclick="changeTab('habits')">
                <i class="fas fa-scroll text-xl mr-2"></i>Habits
            </button>
            <button id="tab-rewards" class="flex-1 p-3 text-center transition-colors font-cinzel text-lg border-b-2 border-b-transparent hover:border-b-[#b05c6c] text-gray-400" onclick="changeTab('rewards')">
                <i class="fas fa-trophy text-xl mr-2"></i>Rewards
            </button>
            <button id="tab-punishments" class="flex-1 p-3 text-center transition-colors font-cinzel text-lg border-b-2 border-b-transparent hover:border-b-[#b05c6c] text-gray-400" onclick="changeTab('punishments')">
                <i class="fas fa-hand-paper text-xl mr-2"></i>Punishments
            </button>
        </div>

        <!-- Content Areas -->
        <div id="habits-content" class="tab-content space-y-4">
            <div id="habits-list" class="space-y-4">
                <!-- Habits will be rendered here -->
                <p class="text-gray-500 text-center py-8" id="loading-habits">Loading habits...</p>
            </div>
            <button class="btn-primary w-full mt-4" onclick="toggleHabitForm()">Add New Habit</button>
            <div id="habit-form" class="card p-4 mt-4 hidden">
                <h3 class="text-xl mb-3">New Habit Registry</h3>
                <div class="space-y-3">
                    <input type="text" id="new-habit-desc" placeholder="Habit Description (e.g., Meditate for 10 minutes)" class="input-style w-full">
                    <div class="flex space-x-3">
                        <input type="number" id="new-habit-points" placeholder="Points" min="1" class="input-style w-1/3" value="10">
                        <input type="number" id="new-habit-times" placeholder="Daily Goal" min="1" class="input-style w-1/3" value="1">
                        <select id="new-habit-assignee" class="input-style w-1/3">
                            <option value="keeper">Assigned to Keeper</option>
                            <option value="nightingale">Assigned to Nightingale</option>
                        </select>
                    </div>
                    <div class="flex space-x-2 pt-2">
                        <button class="btn-primary flex-1" onclick="addHabit()">Register Habit</button>
                        <button class="btn-primary flex-1 bg-gray-600 hover:bg-gray-700" onclick="generateExample('habit')">Generate Example</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="rewards-content" class="tab-content space-y-4 hidden">
            <div id="rewards-list" class="space-y-4">
                <!-- Rewards will be rendered here -->
                <p class="text-gray-500 text-center py-8">Loading rewards...</p>
            </div>
            <button class="btn-primary w-full mt-4" onclick="toggleRewardForm()">Add New Reward</button>
            <div id="reward-form" class="card p-4 mt-4 hidden">
                <h3 class="text-xl mb-3">New Reward Registry</h3>
                <div class="space-y-3">
                    <input type="text" id="new-reward-title" placeholder="Reward Title (e.g., A Fine Wine)" class="input-style w-full">
                    <div class="flex space-x-3">
                        <input type="number" id="new-reward-cost" placeholder="Point Cost" min="1" class="input-style w-1/3" value="50">
                        <input type="text" id="new-reward-desc" placeholder="Description" class="input-style w-2/3">
                    </div>
                    <div class="flex space-x-2 pt-2">
                        <button class="btn-primary flex-1" onclick="addReward()">Register Reward</button>
                        <button class="btn-primary flex-1 bg-gray-600 hover:bg-gray-700" onclick="generateExample('reward')">Generate Example</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="punishments-content" class="tab-content space-y-4 hidden">
            <div id="punishments-list" class="space-y-4">
                <!-- Punishments will be rendered here -->
                <p class="text-gray-500 text-center py-8">Loading punishments...</p>
            </div>
            <button class="btn-primary w-full mt-4" onclick="togglePunishmentForm()">Add New Punishment</button>
            <div id="punishment-form" class="card p-4 mt-4 hidden">
                <h3 class="text-xl mb-3">New Punishment Registry</h3>
                <div class="space-y-3">
                    <input type="text" id="new-punishment-title" placeholder="Punishment Title (e.g., The Silent Hour)" class="input-style w-full">
                    <input type="text" id="new-punishment-desc" placeholder="Description" class="input-style w-full">
                    <div class="flex space-x-2 pt-2">
                        <button class="btn-primary flex-1" onclick="addPunishment()">Register Punishment</button>
                        <button class="btn-primary flex-1 bg-gray-600 hover:bg-gray-700" onclick="generateExample('punishment')">Generate Example</button>
                    </div>
                </div>
            </div>
        </div>
        
    </div> <!-- End of Main Tabs Container -->

    <footer class="text-center mt-12 text-xs text-gray-600">
        <p>Built with Firebase & the Will of the Covenant</p>
    </footer>


    <!-- External JavaScript Modules -->
    <script type="module" src="./firebase_config.js"></script>
    <script type="module" src="./script.js"></script>

</body>
</html>
